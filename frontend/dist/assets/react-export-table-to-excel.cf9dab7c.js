import{c}from"./dayjs.3ab4eba5.js";import{r as _}from"./react.93c2303f.js";import{s as D}from"./react-dom.25c977a4.js";var j={},b={},s={},x={},p={},g=c&&c.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(p,"__esModule",{value:!0});const u=g(_.exports),O=D,k=["string","number","boolean"];function T({header:e,body:t}){const r=u.default.createElement("tr",null,e.map(n=>u.default.createElement("th",{key:n},n))),o=t.map((n,l)=>Array.isArray(n)?u.default.createElement("tr",{key:l},n.map((a,i)=>u.default.createElement("th",{key:i}," ",a," "))):n!==null&&typeof n=="object"?u.default.createElement("tr",{key:l},Object.entries(n).map(([a,i],f)=>typeof i=="object"?(console.error(`typeof ${a} is incorrect, only accept ${k.join(", ")} `),u.default.createElement("th",{key:f})):u.default.createElement("th",{key:f},u.default.createElement(u.default.Fragment,null,i)))):(console.error(`
       data structure is incorrect,  
       data structure type -> 
       " type data = Array<{ [key: string]: string | number | boolean }> 
                         or 
        type data = Array<(string | number | boolean)[]>"
      `),null));return(0,O.renderToString)(u.default.createElement("table",null,u.default.createElement("tbody",null,r,o)))}p.default=T;(function(e){var t=c&&c.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(e,"__esModule",{value:!0}),e.createTable=e.template=e.uri=e.format=e.base64=void 0;function r(l){return window.btoa(unescape(encodeURIComponent(l)))}e.base64=r;function o(l,a){return l.replace(/{(\w+)}/g,(i,f)=>a[f])}e.format=o,e.uri="data:application/vnd.ms-excel;base64,",e.template='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta charset="UTF-8"><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body>{table}</body></html>';var n=p;Object.defineProperty(e,"createTable",{enumerable:!0,get:function(){return t(n).default}})})(x);var M=c&&c.__createBinding||(Object.create?function(e,t,r,o){o===void 0&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){o===void 0&&(o=r),e[o]=t[r]}),P=c&&c.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),W=c&&c.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&M(t,e,r);return P(t,e),t};Object.defineProperty(s,"__esModule",{value:!0});s.downloadExcel=s.excel=void 0;const d=W(x);function y(){return document?!0:((process==null?void 0:"production")!=="production"&&console.error("Failed to access document object"),!1)}function E(e,t){const r=window.document.createElement("a");return r.href=d.uri+d.base64(d.format(d.template,t)),r.download=e,document.body.appendChild(r),r.click(),document.body.removeChild(r),!0}function w(e,t){if(e)return e.cloneNode(!0).outerHTML;if(t)return d.createTable(t);console.error("currentTableRef or tablePayload does not exist")}function $({fileName:e,sheet:t,tablePayload:r},o){if(!y())return!1;const n=w(o,r);return E(e,{worksheet:t||"Worksheet",table:n})}s.downloadExcel=$;function C({currentTableRef:e,filename:t,sheet:r}){function o(){if(!y())return!1;const n=w(e),l=`${t}.xls`;return E(l,{worksheet:r||"Worksheet",table:n})}return{onDownload:o}}s.excel=C;Object.defineProperty(b,"__esModule",{value:!0});b.useDownloadExcel=void 0;const m=_.exports,A=s;function N({currentTableRef:e,filename:t,sheet:r}){const[o,n]=(0,m.useState)({});return(0,m.useEffect)(()=>{n({currentTableRef:e,filename:t,sheet:r})},[e,t,r]),(0,m.useMemo)(()=>(0,A.excel)(o),[o])}b.useDownloadExcel=N;(function(e){var t=c&&c.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(e,"__esModule",{value:!0}),e.downloadExcel=e.useDownloadExcel=e.DownloadTableExcel=void 0;const r=t(_.exports),o=b;Object.defineProperty(e,"useDownloadExcel",{enumerable:!0,get:function(){return o.useDownloadExcel}});const n=s;Object.defineProperty(e,"downloadExcel",{enumerable:!0,get:function(){return n.downloadExcel}});const l=({currentTableRef:a,filename:i,sheet:f,children:h})=>{const{onDownload:v}=(0,o.useDownloadExcel)({currentTableRef:a,filename:i,sheet:f});return r.default.createElement("span",{onClick:v},h)};e.DownloadTableExcel=l})(j);export{j as l};
