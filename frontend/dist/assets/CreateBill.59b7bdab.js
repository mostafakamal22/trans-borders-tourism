import{r as N,j as a,a as d,w as F,a8 as O,a9 as B,a6 as E}from"./vendor.c41dc8f7.js";import{S as z}from"./invoice-alt.65e55958.js";import{u as _,F as H}from"./index.96e1eff6.js";import{F as n}from"./FormInput.57b5023d.js";import{e as L}from"./billApiSlice.0fd20620.js";import{l as u,i as r}from"./constants.ffd6e56c.js";import{u as Q}from"./useScroll.83beccce.js";import{c as f,d as M,p as w}from"./constants.96784a27.js";import{c as G,a as J}from"./CreatePassport.033a8806.js";import{p as q}from"./constants.7e1aa417.js";import{t as C}from"./constants.f1b6c079.js";function se(){const[A,D]=N.exports.useState({name:""}),[o,y]=N.exports.useState({date:"",subtotal:0,total:0,taxRate:0,taxDue:0,taxable:0,paymentMethod:"cash",other:""}),[c,h]=N.exports.useState([{type:"Passport",desc:"",price:0,quantity:1}]),[t,x]=N.exports.useState({name:"",nationality:"",state:"accepted",service:"30days",passportId:"",paymentDate:"",servicePrice:0,taxable:53,taxRate:2.65,total:0,sales:0,profit:0}),[m,g]=N.exports.useState({name:"",type:"",employee:"",supplier:"",paymentDate:"",paymentMethod:"cash",cost:0,sales:0,profit:0,paidAmount:0,remainingAmount:0}),[P,$]=N.exports.useState(1),[j,{isLoading:k,isSuccess:T}]=L(),S=async s=>{if(s<0&&P===1)return;$(P+s);const i=s>0?[...c,{type:"Other",desc:"",price:0,quantity:1}]:c.splice(0,c.length-1);h(i)},R=async s=>{s.preventDefault();const i=[...c.map(l=>({...l,desc:l.type==="Passport"?t.service==="90days"||t.service==="60days"||t.service==="30days"?" \u0641\u064A\u0632\u0627 "+w[t.service]:w[t.service]:l.type==="Ticket"?m.type:l.desc,data:l.type==="Passport"?{...t,name:A.name,paymentDate:o.date}:l.type==="Ticket"?{...m,name:A.name,paymentDate:o.date}:null}))],e={customer:{...A},details:[...i],total:o.total,date:o.date,paymentMethod:o.paymentMethod,other:o.other};await j(e)};N.exports.useEffect(()=>{T&&(D({name:""}),y({date:"",subtotal:0,total:0,taxRate:0,taxDue:0,taxable:0,paymentMethod:"cash",other:""}),h([{type:"Passport",desc:"",price:0,quantity:1}]),x({name:"",nationality:"",state:"accepted",service:"30days",passportId:"",paymentDate:"",servicePrice:0,taxable:53,taxRate:2.65,total:0,sales:0,profit:0}),g({name:"",type:"",employee:"",supplier:"",paymentDate:"",paymentMethod:"cash",cost:0,sales:0,profit:0,paidAmount:0,remainingAmount:0}))},[T]);const I=Object.keys(q).filter(s=>s!=="later").map(s=>a("option",{value:s,children:q[s]},s));return Q("createBill"),_("\u0625\u0636\u0627\u0641\u0629 \u0641\u0627\u062A\u0648\u0631\u0629 \u062C\u062F\u064A\u062F\u0629"),d("section",{id:"createBill",className:"w-full",children:[d("h3",{className:"mb-10 flex items-center justify-center rounded bg-red-800 px-2 py-4 text-center text-xl font-bold text-white shadow ",children:[a(z,{className:"mr-1 h-16 w-16 drop-shadow"}),a("span",{children:"\u0625\u0636\u0627\u0641\u0629 \u0641\u0627\u062A\u0648\u0631\u0629 \u062C\u062F\u064A\u062F\u0629"})]}),d("form",{onSubmit:R,children:[a("p",{className:"my-4 rounded bg-red-800 p-2 text-lg font-bold text-white",children:"[ \u0628\u064A\u0627\u0646\u0627\u062A \u0627\u0644\u0639\u0645\u064A\u0644 ]"}),a("div",{className:"flex flex-wrap items-center justify-center gap-4 px-5 py-5 font-semibold",children:a(n,{label:"\u0625\u0633\u0645 \u0627\u0644\u0639\u0645\u064A\u0644",name:"customerName",labeClassNames:u.default,className:r.default,type:"text",value:A.name,onChange:s=>D({...A,name:s.target.value}),required:!0})}),a("p",{className:"my-4 rounded bg-red-800 p-2 text-lg font-bold text-white",children:"[ \u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u0641\u0627\u062A\u0648\u0631\u0629 ]"}),c.map((s,i)=>d("div",{className:"flex flex-wrap items-center justify-center gap-4 border-b-4 border-red-700 px-5 py-5 font-semibold",children:[a("select",{name:`itemType${i}`,id:`itemType${i}`,className:r.default,value:s.type,onChange:e=>{const l=[...c];l[i].type=e.target.value,h(l)},children:["Passport","Ticket","Other"].map(e=>a("option",{value:e,children:e},e))}),a("label",{htmlFor:`itemType${i}`,className:u.default,children:"\u0646\u0648\u0639 \u0627\u0644\u062E\u062F\u0645\u0629"}),c[i].type==="Other"&&d(F,{children:[a(n,{label:"\u0648\u0635\u0641 \u0627\u0644\u062E\u062F\u0645\u0629",name:`itemName${i}`,labeClassNames:u.default,className:r.default,type:"text",value:s.desc,onChange:e=>{const l=[...c];l[i].desc=e.target.value,h(l)}}),a(n,{label:"\u0627\u0644\u0643\u0645\u064A\u0629",name:`itemQuantity${i}`,labeClassNames:u.default,className:r.default,type:"number",value:s.quantity,onChange:e=>{const l=[...c];l[i].quantity=+e.target.value,h(l);const b=c.reduce((v,p)=>v+p.price*p.quantity,0);y({...o,subtotal:+b.toFixed(2),total:+b.toFixed(2)+ +o.taxDue.toFixed(2)+ +o.taxRate.toFixed(2)+ +o.taxable.toFixed(2)})},min:1,required:!0}),a(n,{label:"\u0633\u0639\u0631 \u0627\u0644\u062E\u062F\u0645\u0629",name:`itemPrice${i}`,labeClassNames:u.default,className:r.default,type:"number",value:s.price,onChange:e=>{const l=[...c];l[i].price=+e.target.value,h(l);const b=c.reduce((v,p)=>v+p.price*p.quantity,0);y({...o,total:+b.toFixed(2)})},min:0,step:.01,required:!0})]}),s.type==="Passport"&&d(F,{children:[a(n,{label:f[1],name:"customerNationality",labeClassNames:u.default,className:r.default,type:"text",value:t.nationality,onChange:e=>x({...t,nationality:e.target.value})}),a(n,{label:f[2],name:"passportId",labeClassNames:u.default,className:r.default,type:"text",value:t.passportId,onChange:e=>x({...t,passportId:e.target.value}),required:!0}),a(n,{label:f[5],name:"servicePrice",labeClassNames:u.default,className:r.default,type:"number",value:t.servicePrice,onChange:e=>{x({...t,servicePrice:+e.target.value,sales:t.service==="change_situation"?+e.target.value+t.taxRate+t.taxable:0,total:t.service==="change_situation"?+e.target.value+t.taxRate+t.taxable:0,profit:0});const l=[...c];l[i].price=t.service==="change_situation"?+e.target.value+t.taxRate+t.taxable:l[i].price,h(l);const b=c.reduce((v,p)=>v+p.price*p.quantity,0);y({...o,total:+b.toFixed(2)})},min:0,step:.01}),a(n,{label:f[7],name:"taxable",labeClassNames:u.default,className:`${r.default} bg-slate-200`,type:"number",value:t.taxable,disabled:!0,min:0,step:.01}),a(n,{label:f[6],name:"taxRate",labeClassNames:u.default,className:`${r.default} bg-slate-200`,type:"number",value:t.taxRate,disabled:!0,min:0,step:.01}),a(n,{label:f[8],name:"totalPayment",labeClassNames:u.default,className:`${r.default} bg-slate-200`,type:"number",value:t.total,disabled:!0,min:0,step:.01}),a(n,{label:f[10],name:"sales",labeClassNames:u.default,className:r.default,type:"number",value:t.sales,onChange:e=>{x({...t,total:G({sales:+e.target.value,servicePrice:t.servicePrice}),sales:+e.target.value,profit:+J({sales:+e.target.value,servicePrice:t.servicePrice})});const l=[...c];l[i].price=+e.target.value,h(l);const b=c.reduce((v,p)=>v+p.price*p.quantity,0);y({...o,total:+b.toFixed(2)})},min:0,step:.01}),a(n,{label:f[11],name:"profit",labeClassNames:u.default,className:`${r.default} bg-slate-200`,type:"number",value:t.profit,disabled:!0,min:0,step:.01}),a("select",{name:"state",id:"state",className:r.default,value:t.state,onChange:e=>x({...t,state:e.target.value}),children:Object.keys(M).map(e=>a("option",{value:e,children:M[e][0]},e))}),a("label",{htmlFor:"state",className:u.default,children:f[3]}),a("select",{name:"service",id:"service",className:r.default,value:t.service,onChange:e=>x({...t,service:e.target.value}),children:Object.keys(w).map(e=>a("option",{value:e,children:w[e]},e))}),a("label",{htmlFor:"service",className:u.default,children:f[4]})]}),s.type==="Ticket"&&d(F,{children:[a(n,{label:C[1],name:"type",labeClassNames:u.default,className:r.default,type:"text",value:m.type,onChange:e=>g({...m,type:e.target.value})}),a(n,{label:C[2],name:"\u0627\u0633\u0645 \u0627\u0644\u0645\u0648\u0638\u0641",labeClassNames:u.default,className:r.default,type:"text",value:m.employee,onChange:e=>g({...m,employee:e.target.value})}),a(n,{label:C[3],name:"cost",labeClassNames:u.default,className:r.default,type:"number",value:m.cost,onChange:e=>g({...m,cost:+e.target.value,sales:0,profit:0}),min:0,step:.01}),a(n,{label:C[4],name:"sales",labeClassNames:u.default,className:r.default,type:"number",value:m.sales,onChange:e=>{g({...m,sales:+e.target.value,profit:+e.target.value-m.cost,paidAmount:+e.target.value,remainingAmount:0});const l=[...c];l[i].price=+e.target.value,h(l);const b=c.reduce((v,p)=>v+p.price*p.quantity,0);y({...o,total:+b.toFixed(2)})},min:0,step:.01}),a(n,{label:C[5],name:"profit",labeClassNames:u.default,className:`${r.default} bg-slate-200`,type:"number",value:m.profit,disabled:!0,min:0,step:.01}),a(n,{label:"Paid Amount",name:"paidAmount",labeClassNames:u.default,className:r.default,type:"number",value:m.paidAmount,onChange:e=>g({...m,paidAmount:+e.target.value,remainingAmount:m.sales-+e.target.value}),min:0,step:.01}),a(n,{label:"Remaining Amount",name:"remainingAmount",labeClassNames:u.default,className:`${r.default} bg-slate-200`,type:"number",value:m.remainingAmount,disabled:!0,min:0,step:.01}),a(n,{label:C[6],name:"supplier",labeClassNames:u.default,className:r.default,type:"text",value:m.supplier,onChange:e=>g({...m,supplier:e.target.value})})]})]},i)),d("div",{className:"flex justify-around",children:[d("button",{className:"my-5 flex items-center rounded border bg-blue-800 px-2 py-2 text-xs font-bold text-white shadow transition-all duration-300 ease-in-out hover:border-blue-800\r hover:bg-white hover:text-blue-800 sm:px-3 sm:text-sm",onClick:()=>S(1),type:"button",children:[a(O,{className:"mr-1",size:20}),"\u0625\u0636\u0627\u0641\u0629 \u0646\u0648\u0639"]}),d("button",{className:"my-5 flex items-center rounded border bg-red-800 px-2 py-2 text-xs font-bold text-white shadow transition-all duration-300 ease-in-out hover:border-red-800\r hover:bg-white hover:text-red-800 sm:px-3 sm:text-sm",onClick:()=>S(-1),type:"button",children:[a(B,{className:"mr-1",size:20}),"\u062D\u0630\u0641 \u0646\u0648\u0639"]})]}),a("p",{className:"my-4 rounded bg-red-800 p-2 text-lg font-bold text-white",children:"[ \u0628\u064A\u0627\u0646\u0627\u062A \u0627\u0644\u0641\u0627\u062A\u0648\u0631\u0629 ]"}),a("div",{className:"flex flex-wrap items-center justify-center gap-4 px-5 py-5 font-semibold",children:a(n,{label:"\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u0641\u0627\u062A\u0648\u0631\u0629",name:"billDate",labeClassNames:u.default,className:r.default,type:"date",value:o.date,onChange:s=>y({...o,date:s.target.value}),required:!0})}),d("div",{className:"mb-10 flex flex-wrap items-center justify-center gap-4 px-5 py-5 font-semibold",children:[a(n,{label:"Total",name:"billTotal",labeClassNames:u.default,className:`${r.default} bg-slate-200`,type:"number",value:o.total,disabled:!0,step:"0.01",min:0,required:!0}),a("select",{name:"paymentMethod",id:"paymentMethod",className:r.default,value:o.paymentMethod,onChange:s=>{y({...o,paymentMethod:s.target.value}),g({...m,paymentMethod:s.target.value})},children:I}),a("label",{htmlFor:"paymentMethod",className:u.default,children:"Payment Method"}),a("textarea",{className:r.default,name:"other",id:"other",value:o.other,onChange:s=>y({...o,other:s.target.value})}),a("label",{className:u.default,htmlFor:"other",children:"Other Comments"})]}),a(H,{text:{default:"\u062D\u0641\u0638 \u0627\u0644\u0641\u0627\u062A\u0648\u0631\u0629",loading:"\u062C\u0627\u0631\u0649 \u0627\u0644\u062D\u0641\u0638"},isLoading:k,icon:a(E,{className:"ml-1",size:25})})]})]})}export{se as default};
