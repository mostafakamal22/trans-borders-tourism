import{Y as v,a as u,j as e,Z as C,_ as I,r as o,w as k,$ as P}from"./vendor.c17f1326.js";import{S as T}from"./invoice-main.18bb55c4.js";import{l as E,u as L,F as M,P as Q,N as z,a as H}from"./index.755d76fd.js";import{a as O,b as U}from"./invoiceApiSlice.80cf1dec.js";import{i as y}from"./constants.ffd6e56c.js";import{t as B,a as $}from"./Table.d7cc589b.js";import{s as N,u as q}from"./useScroll.40b3b3cf.js";import{u as G,D as V}from"./index.99e40694.js";import{D as Y}from"./DataFetchingErrorMessage.f8995f8e.js";import"./index.esm.a6b2d145.js";import"./dayjs.min.c3329109.js";const Z=({setSearchQuery:r,searchQuery:i,tableRows:n,setTableRows:c,isFilterOpen:f,setIsFilterOpen:h})=>{let p=[];for(let t=10;t<=300;t+=10)p.push(t);const[x,d]=v(),l=x.get("page");return u("div",{id:"filters",className:`${f?"translate-x-0":"-translate-x-60"} duration-350 absolute left-0 top-0 flex h-screen w-60 flex-wrap items-start justify-center gap-4  overflow-x-hidden overflow-y-scroll bg-slate-50 px-4 py-8 text-xs shadow-md transition-all ease-in-out scrollbar-thin scrollbar-track-transparent scrollbar-thumb-gray-400 scrollbar-corner-slate-700 scrollbar-track-rounded-full scrollbar-w-0`,children:[e("button",{className:"absolute top-2 right-2 inline-flex items-center text-xs font-bold text-white sm:text-sm",onClick:()=>h(!f),type:"button",children:e(C,{className:"text-red-700",size:30})}),u("form",{className:"mx-auto my-4 flex flex-col justify-start  gap-4 font-semibold",children:[u("div",{className:"flex basis-full flex-col items-center justify-center gap-2",children:[e("label",{htmlFor:"searchQuery",className:"w-full rounded bg-red-700 p-2 text-white",children:"\u0625\u0633\u0645 \u0627\u0644\u0639\u0645\u064A\u0644"}),e("input",{type:"text",id:"searchQuery",name:"searchQuery",className:y.default,placeholder:"\u0628\u062D\u062B \u0639\u0646 \u0627\u0644\u0641\u0627\u062A\u0648\u0631\u0629 \u0628\u0627\u0644\u0625\u0633\u0645",value:i,onChange:t=>{l&&+l>1&&d({page:"1"}),r(t.target.value)}})]}),u("div",{className:"flex w-full flex-col items-center justify-center gap-2 font-semibold",children:[e("label",{className:"w-full rounded bg-red-700 p-2 text-white",htmlFor:"tableRows",children:"\u0639\u062F\u062F \u0635\u0641\u0648\u0641 \u0627\u0644\u062C\u062F\u0648\u0644"}),e("select",{name:"tableRows",id:"tableRows",className:y.default,value:n,onChange:t=>{l&&+l>1&&d({page:"1"}),c(+t.target.value)},children:p.map(t=>e("option",{value:t,children:t},t))})]})]})]})},_=({searchQuery:r,isFilterOpen:i,setIsFilterOpen:n,count:c})=>u("h3",{id:"filterHeader",className:"relative flex basis-full flex-row-reverse flex-wrap items-center justify-center rounded  bg-red-700 p-3 text-center font-bold text-white shadow",children:[u("button",{id:"openFilters",className:"absolute top-2 right-2 flex items-center justify-center rounded bg-slate-50 p-2 text-xs font-semibold text-gray-600 shadow sm:text-sm",onClick:()=>n(!i),type:"button",children:[e(I,{className:"mr-1",size:25}),i?"\u0625\u063A\u0644\u0627\u0642 \u0627\u0644\u0641\u0644\u062A\u0631\u0629":"\u0641\u062A\u062D \u0627\u0644\u0641\u0644\u062A\u0631\u0629"]}),e("p",{className:"mb-5 basis-full text-2xl underline decoration-sky-500 decoration-wavy decoration-2 underline-offset-8",children:"\u0641\u0644\u062A\u0640\u0640\u0631\u0629 \u0627\u0644\u0641\u0640\u0640\u0648\u0627\u062A\u064A\u0640\u0640\u0631"}),e("span",{children:" \u0627\u0644\u0641\u0640\u0648\u0627\u062A\u064A\u0640\u0631 \u0627\u0644\u0645\u062D\u0641\u0648\u0638\u0629"}),!r&&e("span",{className:"mx-1 rounded-md bg-blue-500 p-1 text-white",children:" \u0627\u0644\u0643\u0644\u064A\u0629 "}),r&&e("span",{className:"mx-1 rounded-md bg-rose-500 p-1 text-white",children:" \u0625\u0633\u0645 \u0627\u0644\u0639\u0645\u064A\u0644 "+r}),u("span",{children:["(",c,")"]})]});function oe(){const[r,i]=o.exports.useState(""),n=o.exports.useDeferredValue(r),c=o.exports.useRef(!1),f=o.exports.useRef(null),{onDownload:h}=E.useDownloadExcel({currentTableRef:f.current,filename:"Old Invoices table",sheet:"Old Invoices"}),[p,x]=o.exports.useState(50),[d,l]=o.exports.useState(!1),[t]=v(),g=t.get("page")?+t.get("page"):1,{data:s,isLoading:b,isFetching:m,isSuccess:w,error:A}=O({query:{name:n.trim()},option:{limit:p,page:g}}),a=s!=null&&s.docs?s.docs:[],[F,{isLoading:R}]=U(),D=o.exports.useCallback(async(S,j)=>{S.preventDefault(),await F(j)},[]);return o.exports.useEffect(()=>{c.current&&w&&!m&&!b?N():c.current=!0},[g,w,m,b,N]),q("filterHeader"),G("\u0627\u0644\u0641\u0648\u0627\u062A\u064A\u0631"),L({setIsFilterOpen:l,isFilterOpen:d}),A?e(Y,{}):!s||b?e(V,{}):u("main",{className:"w-full",children:[u("h2",{className:"my-4 mb-10 flex items-center justify-center rounded bg-red-700 px-2 py-4 text-3xl font-bold text-white shadow",children:[e("span",{className:"mr-2 flex items-center justify-center",children:e(T,{className:"h-20 w-20 drop-shadow"})}),"\u0627\u0644\u0641\u0648\u0627\u062A\u064A\u0631"]}),e(_,{searchQuery:r,setIsFilterOpen:l,isFilterOpen:d,count:s!=null&&s.totalDocs?s.totalDocs:0}),e(Z,{searchQuery:r,setSearchQuery:i,tableRows:p,setTableRows:x,setIsFilterOpen:l,isFilterOpen:d}),m&&e(M,{isFetching:m}),(a==null?void 0:a.length)>0&&u(k,{children:[u("button",{className:"mx-auto my-5 flex items-center justify-center gap-1 rounded border bg-green-200 px-2 py-2 text-xs font-bold text-green-800 shadow transition-all duration-300 ease-in-out hover:border-green-800 hover:bg-white\r hover:text-green-800 sm:px-3 sm:text-sm",onClick:h,children:[e(P,{size:20}),e("span",{children:"Export excel"})]}),e(Q,{tableRow:B,tableHeader:$,tableBodyData:a,options:s,handleRemoving:D,isDeleting:R,ref:f})]}),!n&&!m&&(a==null?void 0:a.length)===0&&e(z,{customMsg:["\u0641\u0648\u0627\u062A\u064A\u0631","\u0627\u0644\u0641\u0648\u0627\u062A\u064A\u0631"]}),n&&(a==null?void 0:a.length)===0&&!m&&e(H,{})]})}export{oe as default};
